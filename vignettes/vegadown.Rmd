---
title: "vegadown"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{vegadown}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library("vegadown")

# makes it easier to set data URL in specs
vw_set_base_url("https://cdn.jsdelivr.net/npm/vega-datasets@2")
```

Using only [vegawidget](https://vegawidget.github.io/vegawidget), you have to compose a Vega or Vega-Lite spec (vegaspec) using lists:

```{r vwcars}
as_vegaspec(
  list(
    `$schema` = "https://vega.github.io/schema/vega-lite/v4.json",
    description = "A scatterplot showing horsepower and miles per gallons for various cars.",
    data = list("url" = "data/cars.json"),
    mark = "point",
    encoding = list(
      x = list(field = "Horsepower", type = "quantitative"),
      y = list(field = "Miles_per_Gallon", type = "quantitative")
    )  
  ) 
)
```

When coding, it can be a bit awkward to compose vegaspecs using lists. 
Using this packaage, you can compose using JSON or YAML in RMarkdown by specifying a chunk's language as `vegajson`, `vegayaml` or `vegayml`.

## First steps

Using vegadown, you can compose vegaspecs using JSON or YAML code chunks in RMarkdown. 
There are two things keep in mind, initially:

- use `vegajson` or `vegayaml` (or `vegayml`) as the language of your code chunk.
- afterwards, you can access a given vegaspec using `vegadown()`.

If you label a code chunk as `json-cars`, the vegaspec will be available using `vegadown("json-cars")`.
You can get the names of available specs using `vegadown_names()`.

### Examples

Here's what your code chunk would look like:

````
```{vegajson json-cars}`r ''`
{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "description": "A scatterplot showing horsepower and miles per gallons for various cars.",
  "data": {"url": "data/cars.json"},
  "mark": "point",
  "encoding": {
    "x": {"field": "Horsepower", "type": "quantitative"},
    "y": {"field": "Miles_per_Gallon", "type": "quantitative"}
  }
}
```
````

Here's how it would appear:

```{vegajson json-cars}
{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "description": "A scatterplot showing horsepower and miles per gallons for various cars.",
  "data": {"url": "data/cars.json"},
  "mark": "point",
  "encoding": {
    "x": {"field": "Horsepower", "type": "quantitative"},
    "y": {"field": "Miles_per_Gallon", "type": "quantitative"}
  }
}
```

As noted above, you can also use YAML (`vegayaml` or `vegayml`); we can also specify sizing options, just as with vegawidget.

````
```{vegayaml yaml-cars, vega.height=300, vega.width=300}`r ''`
```
````

```{vegayaml yaml-cars, vega.height=300, vega.width=300}
$schema: "https://vega.github.io/schema/vega-lite/v4.json"
description: "A scatterplot showing weight and miles per gallons for various cars."
data: 
  url: "data/cars.json"
mark: point
encoding: 
  x: 
    field: Weight_in_lbs
    type: quantitative
  "y": 
    field: Miles_per_Gallon
    type: quantitative
```

Note that we quoted the `"y"` for the y-encoding; this is because of the [(many) reserved Boolean keywords](https://yaml.org/type/bool.html) in YAML.

To get the available labels:

```{r}
vegadown_labels()
```

You can access a particular spec using `vegadown()`:

```{r}
str(vegadown("json-cars"))
```

## Interpolation from R

## Behind the scenes
